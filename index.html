<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Condessa IPTV - Assinatura</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase App e Auth -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <style>
        :root {
            --primary-bg: #121212;
            --secondary-bg: #1e1e1e;
            --card-bg: #252525;
            --accent-red: #e50914;
            --accent-yellow: #f5c518;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Telas de Login */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }

        .login-modal {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 10px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .logo {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--accent-red), var(--accent-yellow));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 1rem;
        }

        .login-input {
            width: 100%;
            padding: 1rem;
            margin: 0.5rem 0;
            background: var(--secondary-bg);
            border: 1px solid #333;
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .login-input:focus {
            border-color: var(--accent-red);
            outline: none;
        }

        .login-btn {
            width: 100%;
            padding: 1rem;
            background: var(--accent-red);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 1rem;
            transition: background 0.3s;
            font-weight: bold;
        }

        .login-btn:hover {
            background: #f40612;
        }

        .login-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }

        .admin-link, .register-link {
            margin-top: 1rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .admin-link:hover, .register-link:hover {
            color: var(--accent-yellow);
        }

        .error-message {
            color: #ff4444;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        .success-message {
            color: #4CAF50;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        .hidden {
            display: none !important;
        }

        /* Loading Spinner */
        .spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--accent-red);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Resto do CSS permanece igual... */
        .dashboard-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-bg);
            z-index: 4000;
            padding: 2rem;
            overflow-y: auto;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .dashboard-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid #333;
            padding-bottom: 1rem;
            flex-wrap: wrap;
        }

        .dashboard-tab {
            padding: 0.8rem 1.5rem;
            background: var(--secondary-bg);
            border: none;
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s;
        }

        .dashboard-tab.active {
            background: var(--accent-red);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-yellow);
            margin: 0.5rem 0;
        }

        .logout-btn {
            background: var(--accent-red);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Interface Principal */
        #main-interface {
            min-height: 100vh;
        }

        header {
            background-color: var(--secondary-bg);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .header-logo {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--accent-red), var(--accent-yellow));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .admin-btn {
            background: var(--accent-yellow);
            color: black;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        .admin-btn:hover {
            background: #e6b800;
        }

        .logout-btn-small {
            background: transparent;
            border: 1px solid var(--text-secondary);
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .logout-btn-small:hover {
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .nav-tabs {
            display: flex;
            justify-content: space-around;
            background-color: var(--secondary-bg);
            padding: 0.5rem 0;
            position: sticky;
            top: 60px;
            z-index: 99;
        }

        .nav-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            padding: 0.5rem;
            transition: all 0.3s ease;
            border-radius: 8px;
            min-width: 60px;
        }

        .nav-tab:hover {
            background-color: rgba(229, 9, 20, 0.1);
        }

        .nav-tab.active {
            color: var(--accent-red);
            background-color: rgba(229, 9, 20, 0.1);
            transform: scale(1.05);
        }

        .nav-tab i {
            font-size: 1.2rem;
            margin-bottom: 0.2rem;
        }

        .main-content {
            padding: 1rem;
            min-height: calc(100vh - 140px);
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .content-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .card-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }

        .card-content {
            padding: 0.8rem;
        }

        .card-title {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Adicione o restante dos estilos conforme necess√°rio */
    </style>
</head>
<body>
    <!-- Tela de Login Principal -->
    <div id="login-overlay" class="login-overlay">
        <div class="login-modal">
            <div class="logo">CONDESSA IPTV</div>
            <p style="margin-bottom: 2rem; color: var(--text-secondary);">Fa√ßa login para acessar o conte√∫do</p>
            
            <input type="email" id="login-email" class="login-input" placeholder="E-mail" value="usuario@teste.com">
            <input type="password" id="login-password" class="login-input" placeholder="Senha" value="123456">
            
            <div id="login-error" class="error-message"></div>
            <div id="login-success" class="success-message"></div>
            
            <button id="login-btn" class="login-btn">
                <span id="login-text">Entrar</span>
                <div id="login-spinner" class="spinner hidden"></div>
            </button>
            
            <div class="register-link" onclick="showRegister()">
                N√£o tem conta? Cadastre-se
            </div>
            
            <div class="admin-link" onclick="showAdminLogin()">
                Acesso Administrativo
            </div>
        </div>
    </div>

    <!-- Tela de Cadastro -->
    <div id="register-overlay" class="login-overlay hidden">
        <div class="login-modal">
            <div class="logo">CONDESSA IPTV</div>
            <p style="margin-bottom: 2rem; color: var(--text-secondary);">Crie sua conta</p>
            
            <input type="email" id="register-email" class="login-input" placeholder="E-mail">
            <input type="password" id="register-password" class="login-input" placeholder="Senha (m√≠nimo 6 caracteres)">
            <input type="password" id="register-confirm-password" class="login-input" placeholder="Confirmar Senha">
            
            <div id="register-error" class="error-message"></div>
            <div id="register-success" class="success-message"></div>
            
            <button id="register-btn" class="login-btn">
                <span id="register-text">Cadastrar</span>
                <div id="register-spinner" class="spinner hidden"></div>
            </button>
            
            <div class="admin-link" onclick="showUserLogin()">
                Voltar para Login
            </div>
        </div>
    </div>

    <!-- Tela de Login Admin -->
    <div id="admin-login-overlay" class="login-overlay hidden">
        <div class="login-modal">
            <div class="logo">CONDESSA ADMIN</div>
            <p style="margin-bottom: 2rem; color: var(--text-secondary);">Acesso Restrito</p>
            
            <input type="text" id="admin-username" class="login-input" placeholder="Admin Usu√°rio" value="admin">
            <input type="password" id="admin-password" class="login-input" placeholder="Admin Senha" value="admin123">
            
            <div id="admin-error" class="error-message"></div>
            
            <button id="admin-login-btn" class="login-btn">
                <span id="admin-login-text">Acessar Dashboard</span>
                <div id="admin-login-spinner" class="spinner hidden"></div>
            </button>
            
            <div class="admin-link" onclick="showUserLogin()">
                Voltar para Login de Usu√°rio
            </div>
        </div>
    </div>

    <!-- Dashboard Admin -->
    <div id="dashboard-overlay" class="dashboard-overlay hidden">
        <div class="dashboard-header">
            <h1>Dashboard Administrativo</h1>
            <button class="logout-btn" onclick="logoutAdmin()">Sair do Admin</button>
        </div>

        <div class="dashboard-tabs">
            <button class="dashboard-tab active" onclick="switchAdminTab('overview')">Vis√£o Geral</button>
            <button class="dashboard-tab" onclick="switchAdminTab('users')">Gerenciar Usu√°rios</button>
            <button class="dashboard-tab" onclick="switchAdminTab('movies')">Gerenciar Filmes</button>
            <button class="dashboard-tab" onclick="switchAdminTab('series')">Gerenciar S√©ries</button>
            <button class="dashboard-tab" onclick="switchAdminTab('tv')">Gerenciar Canais TV</button>
        </div>

        <div id="admin-overview" class="admin-tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Usu√°rios Ativos</h3>
                    <div class="stat-number" id="active-users-count">0</div>
                    <p>Assinaturas v√°lidas</p>
                </div>
                <div class="stat-card">
                    <h3>Receita Mensal</h3>
                    <div class="stat-number" id="monthly-revenue">R$ 0</div>
                    <p>Previs√£o atual</p>
                </div>
                <div class="stat-card">
                    <h3>Total de Usu√°rios</h3>
                    <div class="stat-number" id="total-users">0</div>
                    <p>Cadastrados no sistema</p>
                </div>
                <div class="stat-card">
                    <h3>Conte√∫do Total</h3>
                    <div class="stat-number" id="total-content">0</div>
                    <p>Filmes + S√©ries + Canais</p>
                </div>
            </div>
        </div>

        <!-- Outras abas do admin... -->
    </div>

    <!-- Interface Principal do Usu√°rio -->
    <div id="main-interface" class="hidden">
        <header>
            <div class="header-logo">CONDESSA IPTV</div>
            <div class="user-menu">
                <button class="admin-btn" onclick="showAdminLogin()">
                    <i class="fas fa-cog"></i> Admin
                </button>
                <button class="logout-btn-small" onclick="logoutUser()">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </header>

        <nav class="nav-tabs">
            <div class="nav-tab active" onclick="switchTab('home')">
                <i class="fas fa-home"></i>
                <span>In√≠cio</span>
            </div>
            <div class="nav-tab" onclick="switchTab('movies')">
                <i class="fas fa-film"></i>
                <span>Filmes</span>
            </div>
            <div class="nav-tab" onclick="switchTab('series')">
                <i class="fas fa-tv"></i>
                <span>S√©ries</span>
            </div>
            <div class="nav-tab" onclick="switchTab('tv')">
                <i class="fas fa-broadcast-tower"></i>
                <span>Canais TV</span>
            </div>
            <div class="nav-tab" onclick="switchTab('favorites')">
                <i class="fas fa-heart"></i>
                <span>Favoritos</span>
            </div>
        </nav>

        <main class="main-content">
            <div id="home-tab" class="tab-content active-tab">
                <h2 style="margin-bottom: 1rem;">Bem-vindo ao Condessa IPTV</h2>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                    Seu servi√ßo de streaming premium com os melhores filmes, s√©ries e canais.
                </p>
                
                <div class="content-grid">
                    <!-- Conte√∫do ser√° carregado aqui -->
                    <div class="content-card">
                        <div class="card-image" style="background: linear-gradient(45deg, #e50914, #f5c518); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-play" style="font-size: 3rem; color: white;"></i>
                        </div>
                        <div class="card-content">
                            <div class="card-title">Filme de Exemplo</div>
                            <div class="card-info">
                                <span>A√ß√£o</span>
                                <span>‚≠ê 8.5</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Outras abas... -->
        </main>
    </div>

    <script>
        // üî• CONFIGURA√á√ÉO SIMPLIFICADA DO FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyDWulc3os3K10BExe65cBRj8opLfF9j9KI",
            authDomain: "condessa-iptv.firebaseapp.com",
            projectId: "condessa-iptv",
            storageBucket: "condessa-iptv.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        // Inicializar Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            console.log('Firebase inicializado com sucesso');
        } catch (error) {
            console.error('Erro ao inicializar Firebase:', error);
        }

        const auth = firebase.auth();

        // üîê CREDENCIAIS DO ADMIN
        const ADMIN_CREDENTIALS = {
            username: 'admin',
            password: 'admin123'
        };

        // üìä DADOS DA APLICA√á√ÉO
        let currentUser = null;
        let isAdmin = false;
        let usersData = JSON.parse(localStorage.getItem('condessa_users')) || {};
        let contentData = JSON.parse(localStorage.getItem('condessa_content')) || {
            movies: [],
            series: [],
            channels: []
        };

        // üéØ ELEMENTOS DO DOM
        const elements = {
            // Overlays
            loginOverlay: document.getElementById('login-overlay'),
            registerOverlay: document.getElementById('register-overlay'),
            adminLoginOverlay: document.getElementById('admin-login-overlay'),
            dashboardOverlay: document.getElementById('dashboard-overlay'),
            mainInterface: document.getElementById('main-interface'),

            // Formul√°rios de Login
            loginEmail: document.getElementById('login-email'),
            loginPassword: document.getElementById('login-password'),
            loginBtn: document.getElementById('login-btn'),
            loginText: document.getElementById('login-text'),
            loginSpinner: document.getElementById('login-spinner'),
            loginError: document.getElementById('login-error'),
            loginSuccess: document.getElementById('login-success'),

            // Formul√°rio de Registro
            registerEmail: document.getElementById('register-email'),
            registerPassword: document.getElementById('register-password'),
            registerConfirmPassword: document.getElementById('register-confirm-password'),
            registerBtn: document.getElementById('register-btn'),
            registerText: document.getElementById('register-text'),
            registerSpinner: document.getElementById('register-spinner'),
            registerError: document.getElementById('register-error'),
            registerSuccess: document.getElementById('register-success'),

            // Formul√°rio Admin
            adminUsername: document.getElementById('admin-username'),
            adminPassword: document.getElementById('admin-password'),
            adminLoginBtn: document.getElementById('admin-login-btn'),
            adminLoginText: document.getElementById('admin-login-text'),
            adminLoginSpinner: document.getElementById('admin-login-spinner'),
            adminError: document.getElementById('admin-error')
        };

        // üöÄ INICIALIZA√á√ÉO DA APLICA√á√ÉO
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Aplica√ß√£o inicializada');
            initializeEventListeners();
            checkAuthState();
            
            // Preencher com dados de teste para facilitar
            elements.loginEmail.value = 'usuario@teste.com';
            elements.loginPassword.value = '123456';
            elements.adminUsername.value = 'admin';
            elements.adminPassword.value = 'admin123';
        });

        // üì± CONFIGURA√á√ÉO DE EVENT LISTENERS
        function initializeEventListeners() {
            // Login de usu√°rio
            elements.loginBtn.addEventListener('click', handleUserLogin);
            elements.loginPassword.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleUserLogin();
            });

            // Registro de usu√°rio
            elements.registerBtn.addEventListener('click', handleUserRegister);
            elements.registerConfirmPassword.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleUserRegister();
            });

            // Login admin
            elements.adminLoginBtn.addEventListener('click', handleAdminLogin);
            elements.adminPassword.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleAdminLogin();
            });

            // Observador de estado de autentica√ß√£o do Firebase
            auth.onAuthStateChanged(handleAuthStateChange);
        }

        // üîê MANIPULADOR DE ESTADO DE AUTENTICA√á√ÉO
        function handleAuthStateChange(user) {
            console.log('Estado de autentica√ß√£o alterado:', user);
            
            if (user) {
                currentUser = user;
                console.log('Usu√°rio logado:', user.email);
                
                // Verificar se √© um usu√°rio admin
                if (user.email === 'admin@condessa.com') {
                    isAdmin = true;
                    showAdminDashboard();
                } else {
                    isAdmin = false;
                    showMainInterface();
                }
            } else {
                currentUser = null;
                isAdmin = false;
                showUserLogin();
            }
        }

        // üîë VERIFICA√á√ÉO DE ESTADO DE AUTENTICA√á√ÉO
        function checkAuthState() {
            const user = auth.currentUser;
            if (user) {
                handleAuthStateChange(user);
            } else {
                showUserLogin();
            }
        }

        // üë§ LOGIN DE USU√ÅRIO
        async function handleUserLogin() {
            const email = elements.loginEmail.value.trim();
            const password = elements.loginPassword.value;

            // Valida√ß√£o b√°sica
            if (!email || !password) {
                showError(elements.loginError, 'Por favor, preencha todos os campos.');
                return;
            }

            if (!isValidEmail(email)) {
                showError(elements.loginError, 'Por favor, insira um e-mail v√°lido.');
                return;
            }

            // Mostrar loading
            setButtonLoading(elements.loginBtn, elements.loginText, elements.loginSpinner, true);

            try {
                console.log('Tentando login com:', email);
                
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                console.log('Login bem-sucedido:', userCredential.user);
                
                showSuccess(elements.loginSuccess, 'Login realizado com sucesso!');
                
                // Garantir que o usu√°rio est√° nos dados locais
                if (!usersData[userCredential.user.uid]) {
                    usersData[userCredential.user.uid] = {
                        email: email,
                        plan: '7',
                        startDate: new Date().toISOString(),
                        endDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),
                        status: 'active',
                        createdDate: new Date().toISOString()
                    };
                    saveUsersData();
                }
                
            } catch (error) {
                console.error('Erro no login:', error);
                handleLoginError(error);
            } finally {
                setButtonLoading(elements.loginBtn, elements.loginText, elements.loginSpinner, false);
            }
        }

        // üìù REGISTRO DE USU√ÅRIO
        async function handleUserRegister() {
            const email = elements.registerEmail.value.trim();
            const password = elements.registerPassword.value;
            const confirmPassword = elements.registerConfirmPassword.value;

            // Valida√ß√µes
            if (!email || !password || !confirmPassword) {
                showError(elements.registerError, 'Por favor, preencha todos os campos.');
                return;
            }

            if (!isValidEmail(email)) {
                showError(elements.registerError, 'Por favor, insira um e-mail v√°lido.');
                return;
            }

            if (password.length < 6) {
                showError(elements.registerError, 'A senha deve ter pelo menos 6 caracteres.');
                return;
            }

            if (password !== confirmPassword) {
                showError(elements.registerError, 'As senhas n√£o coincidem.');
                return;
            }

            // Mostrar loading
            setButtonLoading(elements.registerBtn, elements.registerText, elements.registerSpinner, true);

            try {
                console.log('Tentando cadastrar:', email);
                
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                console.log('Cadastro bem-sucedido:', userCredential.user);
                
                // Adicionar usu√°rio aos dados locais
                usersData[userCredential.user.uid] = {
                    email: email,
                    plan: '7',
                    startDate: new Date().toISOString(),
                    endDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),
                    status: 'active',
                    createdDate: new Date().toISOString()
                };
                saveUsersData();
                
                showSuccess(elements.registerSuccess, 'Cadastro realizado com sucesso!');
                
                // Redirecionar para login ap√≥s 2 segundos
                setTimeout(() => {
                    showUserLogin();
                }, 2000);
                
            } catch (error) {
                console.error('Erro no cadastro:', error);
                handleRegisterError(error);
            } finally {
                setButtonLoading(elements.registerBtn, elements.registerText, elements.registerSpinner, false);
            }
        }

        // üîß LOGIN ADMINISTRATIVO
        function handleAdminLogin() {
            const username = elements.adminUsername.value.trim();
            const password = elements.adminPassword.value;

            if (!username || !password) {
                showError(elements.adminError, 'Por favor, preencha todos os campos.');
                return;
            }

            // Mostrar loading
            setButtonLoading(elements.adminLoginBtn, elements.adminLoginText, elements.adminLoginSpinner, true);

            // Simular verifica√ß√£o (em produ√ß√£o, isso seria no backend)
            setTimeout(() => {
                if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                    console.log('Login admin bem-sucedido');
                    isAdmin = true;
                    showAdminDashboard();
                } else {
                    showError(elements.adminError, 'Credenciais administrativas inv√°lidas.');
                }
                setButtonLoading(elements.adminLoginBtn, elements.adminLoginText, elements.adminLoginSpinner, false);
            }, 1000);
        }

        // üö® TRATAMENTO DE ERROS DE LOGIN
        function handleLoginError(error) {
            let errorMessage = 'Erro ao fazer login: ';
            
            switch (error.code) {
                case 'auth/user-not-found':
                    errorMessage = 'Usu√°rio n√£o encontrado. Verifique o e-mail ou cadastre-se.';
                    break;
                case 'auth/wrong-password':
                    errorMessage = 'Senha incorreta. Tente novamente.';
                    break;
                case 'auth/invalid-email':
                    errorMessage = 'E-mail inv√°lido. Verifique o formato.';
                    break;
                case 'auth/user-disabled':
                    errorMessage = 'Esta conta foi desativada.';
                    break;
                case 'auth/too-many-requests':
                    errorMessage = 'Muitas tentativas. Tente novamente mais tarde.';
                    break;
                default:
                    errorMessage = 'Erro desconhecido. Tente novamente.';
            }
            
            showError(elements.loginError, errorMessage);
        }

        // üö® TRATAMENTO DE ERROS DE REGISTRO
        function handleRegisterError(error) {
            let errorMessage = 'Erro ao cadastrar: ';
            
            switch (error.code) {
                case 'auth/email-already-in-use':
                    errorMessage = 'Este e-mail j√° est√° em uso. Tente fazer login.';
                    break;
                case 'auth/invalid-email':
                    errorMessage = 'E-mail inv√°lido. Verifique o formato.';
                    break;
                case 'auth/operation-not-allowed':
                    errorMessage = 'Opera√ß√£o n√£o permitida.';
                    break;
                case 'auth/weak-password':
                    errorMessage = 'Senha muito fraca. Use pelo menos 6 caracteres.';
                    break;
                default:
                    errorMessage = 'Erro ao criar conta. Tente novamente.';
            }
            
            showError(elements.registerError, errorMessage);
        }

        // üéØ FUN√á√ïES DE NAVEGA√á√ÉO
        function showUserLogin() {
            hideAllScreens();
            elements.loginOverlay.classList.remove('hidden');
            clearMessages();
            console.log('Mostrando tela de login usu√°rio');
        }

        function showRegister() {
            hideAllScreens();
            elements.registerOverlay.classList.remove('hidden');
            clearMessages();
            console.log('Mostrando tela de registro');
        }

        function showAdminLogin() {
            hideAllScreens();
            elements.adminLoginOverlay.classList.remove('hidden');
            clearMessages();
            console.log('Mostrando tela de login admin');
        }

        function showMainInterface() {
            hideAllScreens();
            elements.mainInterface.classList.remove('hidden');
            console.log('Mostrando interface principal');
        }

        function showAdminDashboard() {
            hideAllScreens();
            elements.dashboardOverlay.classList.remove('hidden');
            updateAdminDashboard();
            console.log('Mostrando dashboard admin');
        }

        function hideAllScreens() {
            elements.loginOverlay.classList.add('hidden');
            elements.registerOverlay.classList.add('hidden');
            elements.adminLoginOverlay.classList.add('hidden');
            elements.dashboardOverlay.classList.add('hidden');
            elements.mainInterface.classList.add('hidden');
        }

        // üö™ FUN√á√ïES DE LOGOUT
        function logoutUser() {
            auth.signOut().then(() => {
                console.log('Usu√°rio deslogado');
                currentUser = null;
                isAdmin = false;
                showUserLogin();
            }).catch(error => {
                console.error('Erro ao fazer logout:', error);
            });
        }

        function logoutAdmin() {
            isAdmin = false;
            showUserLogin();
            console.log('Admin deslogado');
        }

        // üíæ FUN√á√ïES DE DADOS
        function saveUsersData() {
            localStorage.setItem('condessa_users', JSON.stringify(usersData));
            console.log('Dados de usu√°rios salvos');
        }

        function saveContentData() {
            localStorage.setItem('condessa_content', JSON.stringify(contentData));
            console.log('Dados de conte√∫do salvos');
        }

        // üìä ATUALIZA√á√ÉO DO DASHBOARD ADMIN
        function updateAdminDashboard() {
            const activeUsers = Object.values(usersData).filter(user => 
                new Date(user.endDate) > new Date() && user.status === 'active'
            ).length;

            const totalUsers = Object.keys(usersData).length;
            const monthlyRevenue = activeUsers * 30;
            const totalContent = contentData.movies.length + contentData.series.length + contentData.channels.length;

            document.getElementById('active-users-count').textContent = activeUsers;
            document.getElementById('total-users').textContent = totalUsers;
            document.getElementById('monthly-revenue').textContent = `R$ ${monthlyRevenue}`;
            document.getElementById('total-content').textContent = totalContent;
        }

        function switchAdminTab(tabName) {
            console.log('Alternando para aba:', tabName);
            // Implementar l√≥gica de altern√¢ncia de abas
        }

        function switchTab(tabName) {
            console.log('Alternando para aba:', tabName);
            // Implementar l√≥gica de altern√¢ncia de abas do usu√°rio
        }

        // üõ†Ô∏è FUN√á√ïES UTILIT√ÅRIAS
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function setButtonLoading(button, textElement, spinnerElement, isLoading) {
            if (isLoading) {
                button.disabled = true;
                textElement.textContent = 'Carregando...';
                spinnerElement.classList.remove('hidden');
            } else {
                button.disabled = false;
                if (button === elements.loginBtn) textElement.textContent = 'Entrar';
                if (button === elements.registerBtn) textElement.textContent = 'Cadastrar';
                if (button === elements.adminLoginBtn) textElement.textContent = 'Acessar Dashboard';
                spinnerElement.classList.add('hidden');
            }
        }

        function showError(element, message) {
            element.textContent = message;
            element.style.display = 'block';
            setTimeout(() => {
                element.style.display = 'none';
            }, 5000);
        }

        function showSuccess(element, message) {
            element.textContent = message;
            element.style.display = 'block';
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }

        function clearMessages() {
            elements.loginError.style.display = 'none';
            elements.loginSuccess.style.display = 'none';
            elements.registerError.style.display = 'none';
            elements.registerSuccess.style.display = 'none';
            elements.adminError.style.display = 'none';
        }

        // üåü INICIALIZAR DADOS DE EXEMPLO SE NECESS√ÅRIO
        function initializeSampleData() {
            if (Object.keys(usersData).length === 0) {
                console.log('Inicializando dados de exemplo...');
                
                // Adicionar alguns usu√°rios de exemplo
                usersData = {
                    'user1': {
                        email: 'usuario@teste.com',
                        plan: '30',
                        startDate: new Date().toISOString(),
                        endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),
                        status: 'active',
                        createdDate: new Date().toISOString()
                    }
                };
                saveUsersData();
            }

            if (contentData.movies.length === 0) {
                contentData.movies = [
                    {
                        id: 1,
                        title: "Vingadores: Ultimato",
                        genre: "A√ß√£o, Aventura",
                        rating: 8.4,
                        image: "https://image.tmdb.org/t/p/w500/q6725aR8Zs4IwGMXzZT8aC8lh41.jpg",
                        videoUrl: "https://www.youtube.com/embed/g6ng8iy-l0U",
                        description: "Os Vingadores precisam se reunir novamente para desfazer as a√ß√µes de Thanos."
                    }
                ];
                saveContentData();
            }
        }

        // Inicializar dados de exemplo
        initializeSampleData();
    </script>
</body>
</html>
